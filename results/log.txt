1. DATA LOADING AND PREPROCESSING
Loading LFW dataset (min_faces=70, resize=0.5)...
Dataset loaded: 1288 samples, 7 classes
Image shape: 62x47 = 2914 features

DATASET STATISTICS
Total samples: 1288
Number of features: 2914
Number of classes: 7

Pixel statistics
Range: [0.0000, 1.0000]
Mean: 0.5084
Std: 0.1741

Class distribution
Min samples per class: 71
Max samples per class: 530
Mean samples per class: 184.0
Std: 150.2

Preprocessing data...
Train set: 1030 samples
Test set: 258 samples
Applying z-score standardization...
Train mean: -0.0000, std: 1.0000
Test mean: -0.0082, std: 0.9928
Image shape: 62x47, Total features: 2914, Classes: 7

2. EXPLORATORY DATA ANALYSIS
Generating Analytics Plots...

3. ABLATION STUDY (PCA VS AUTOENCODER)
Testing different numbero of components/latent dimensions: [25, 50, 75, 100, 150]

Running PCA via SVD Experiments

--- PCA with 25 components ---
   Variance explained: 76.03%
   Reconstruction MSE: 0.243072
   SVM Test Accuracy: 0.6860

--- PCA with 50 components ---
   Variance explained: 83.70%
   Reconstruction MSE: 0.179572
   SVM Test Accuracy: 0.7093

--- PCA with 75 components ---
   Variance explained: 87.83%
   Reconstruction MSE: 0.144315
   SVM Test Accuracy: 0.7364

--- PCA with 100 components ---
   Variance explained: 90.53%
   Reconstruction MSE: 0.120835
   SVM Test Accuracy: 0.7481

--- PCA with 150 components ---
   Variance explained: 93.77%
   Reconstruction MSE: 0.092244
   SVM Test Accuracy: 0.7364

Best PCA: 100 components (Acc: 0.7481)

Running Autoencoder Experiments

--- AE Latent Dim: 25 ---
Training AE (Latent: 25)...
  Epoch: 1/200 | Train: 0.77594 | Val: 0.63544
  Epoch: 20/200 | Train: 0.33918 | Val: 0.32273
  Epoch: 40/200 | Train: 0.30208 | Val: 0.28720
  Epoch: 60/200 | Train: 0.29437 | Val: 0.27655
  Epoch: 80/200 | Train: 0.29345 | Val: 0.27906
  Early stopping at epoch 84

--- AE Latent Dim: 50 ---
Training AE (Latent: 50)...
  Epoch: 1/200 | Train: 0.77424 | Val: 0.65753
  Epoch: 20/200 | Train: 0.34743 | Val: 0.31872
  Epoch: 40/200 | Train: 0.30569 | Val: 0.29475
  Epoch: 60/200 | Train: 0.29018 | Val: 0.27822
  Epoch: 80/200 | Train: 0.27485 | Val: 0.26887
  Early stopping at epoch 93

--- AE Latent Dim: 75 ---
Training AE (Latent: 75)...
  Epoch: 1/200 | Train: 0.76297 | Val: 0.60771
  Epoch: 20/200 | Train: 0.33353 | Val: 0.30957
  Epoch: 40/200 | Train: 0.29660 | Val: 0.28314
  Epoch: 60/200 | Train: 0.28761 | Val: 0.27878
  Epoch: 80/200 | Train: 0.27669 | Val: 0.27120
  Early stopping at epoch 82

--- AE Latent Dim: 100 ---
Training AE (Latent: 100)...
  Epoch: 1/200 | Train: 0.78125 | Val: 0.59532
  Epoch: 20/200 | Train: 0.33748 | Val: 0.30719
  Epoch: 40/200 | Train: 0.29980 | Val: 0.28309
  Epoch: 60/200 | Train: 0.28407 | Val: 0.27391
  Epoch: 80/200 | Train: 0.27421 | Val: 0.26701
  Epoch: 100/200 | Train: 0.27035 | Val: 0.26651
  Epoch: 120/200 | Train: 0.26219 | Val: 0.26040
  Early stopping at epoch 127

--- AE Latent Dim: 150 ---
Training AE (Latent: 150)...
  Epoch: 1/200 | Train: 0.77459 | Val: 0.73815
  Epoch: 20/200 | Train: 0.33045 | Val: 0.31445
  Epoch: 40/200 | Train: 0.30204 | Val: 0.28569
  Early stopping at epoch 54

Best Autoencoder: 100 dimensions (Acc: 0.7752)

Generating Reconstruction Comparison Plot...

4. CLASSIFICATION (SVM vs NEURAL NETWORK)

Training Classifiers on PCA features (Dim: 100)
Running SVM Grid Search for PCA...

--- SVM GRID SEARCH STARTING ---
Hyperparameters grid: {'C': [0.1, 1, 10], 'kernel': ['rbf', 'linear'], 'gamma': ['scale', 'auto']}
Cross-Validation: 5 folds
Fitting 5 folds for each of 12 candidates, totalling 60 fits

--- SVM GRID SEARCH COMPLETED ---
Best Params: {'C': 10, 'gamma': 'scale', 'kernel': 'rbf'}
Best CV Score: 0.8146

--- METRICS SUMMARY: SVM on PCA ---
Best Params: {'C': 10, 'gamma': 'scale', 'kernel': 'rbf'}
Accuracy: 0.8062
95% Confidence Interval: [0.7558, 0.8488]
Macro F1: 0.7423
Weighted F1: 0.8015
CV Score (Val): 0.8146
ROC AUC (Macro): 0.9800

Running Neural Network Grid Search for PCA...

--- NEURAL NET GRID SEARCH STARTING ---
Hyperparameters Grid: {'hidden_layers': [(128, 64), (256, 128)], 'lr': [0.01, 0.001], 'dropout_rate': [0.1, 0.2], 'weight_decay': [0.001, 0.0001], 'epochs': [50, 100]}
Cross-Validation: 5 Folds
Fitting 5 folds for each of 32 candidates, totalling 160 fits
  Epoch 1/50 - Loss: 2.2993 - Acc: 0.1738
  Epoch 20/50 - Loss: 0.0818 - Acc: 0.9689
  Epoch 40/50 - Loss: 0.0383 - Acc: 0.9883

--- NEURAL NET GRID SEARCH COMPLETED ---
Best Params: {'dropout_rate': 0.1, 'epochs': 50, 'hidden_layers': (256, 128), 'lr': 0.001, 'weight_decay': 0.0001}
Best CV Score: 0.8573
Generating SVM ROC curves for PCA...
Generating NN ROC curves for PCA...

--- METRICS SUMMARY: NN on PCA ---
Best Params: {'dropout_rate': 0.1, 'epochs': 50, 'hidden_layers': (256, 128), 'lr': 0.001, 'weight_decay': 0.0001}
Accuracy: 0.8527
95% Confidence Interval: [0.8062, 0.8953]
Macro F1: 0.8086
Weighted F1: 0.8542
ROC AUC (Macro): 0.9803

Training Classifiers on Autoencoder features (Dim: 100)
Running SVM Grid Search for Autoencoder...

--- SVM GRID SEARCH STARTING ---
Hyperparameters grid: {'C': [0.1, 1, 10], 'kernel': ['rbf', 'linear'], 'gamma': ['scale', 'auto']}
Cross-Validation: 5 folds
Fitting 5 folds for each of 12 candidates, totalling 60 fits

--- SVM GRID SEARCH COMPLETED ---
Best Params: {'C': 10, 'gamma': 'scale', 'kernel': 'rbf'}
Best CV Score: 0.7786

--- METRICS SUMMARY: SVM on Autoencoder ---
Best Params: {'C': 10, 'gamma': 'scale', 'kernel': 'rbf'}
Accuracy: 0.7984
95% Confidence Interval: [0.7481, 0.8450]
Macro F1: 0.7474
Weighted F1: 0.7939
CV Score (Val): 0.7786
ROC AUC (Macro): 0.9710

Running Neural Network Grid Search for Autoencoder...

--- NEURAL NET GRID SEARCH STARTING ---
Hyperparameters Grid: {'hidden_layers': [(128, 64), (256, 128)], 'lr': [0.01, 0.001], 'dropout_rate': [0.1, 0.2], 'weight_decay': [0.001, 0.0001], 'epochs': [50, 100]}
Cross-Validation: 5 Folds
Fitting 5 folds for each of 32 candidates, totalling 160 fits
  Epoch 1/100 - Loss: 2.0360 - Acc: 0.3000
  Epoch 20/100 - Loss: 0.3049 - Acc: 0.8699
  Epoch 40/100 - Loss: 0.1789 - Acc: 0.9320
  Epoch 60/100 - Loss: 0.1043 - Acc: 0.9573
  Epoch 80/100 - Loss: 0.0972 - Acc: 0.9495
  Epoch 100/100 - Loss: 0.0647 - Acc: 0.9718

--- NEURAL NET GRID SEARCH COMPLETED ---
Best Params: {'dropout_rate': 0.2, 'epochs': 100, 'hidden_layers': (256, 128), 'lr': 0.001, 'weight_decay': 0.0001}
Best CV Score: 0.7922
Generating SVM ROC curves for Autoencoder...
Generating NN ROC curves for Autoencoder...

--- METRICS SUMMARY: NN on Autoencoder ---
Best Params: {'dropout_rate': 0.2, 'epochs': 100, 'hidden_layers': (256, 128), 'lr': 0.001, 'weight_decay': 0.0001}
Accuracy: 0.8217
95% Confidence Interval: [0.7752, 0.8682]
Macro F1: 0.7853
Weighted F1: 0.8247
ROC AUC (Macro): 0.9714

5. FINAL MODEL COMPARISON
Comparison Table (Sorted by Accuracy):
model    features  accuracy  precision_macro  recall_macro  f1_macro  f1_weighted  roc_auc_macro  cv_score  acc_lower  acc_upper
   NN         PCA  0.852713         0.809983      0.813088  0.808601     0.854234       0.980303  0.857282   0.806202   0.895349
   NN Autoencoder  0.821705         0.770495      0.802634  0.785275     0.824700       0.971449  0.792233   0.775194   0.868217
  SVM         PCA  0.806202         0.784624      0.714490  0.742269     0.801512       0.980022  0.814563   0.755814   0.848837
  SVM Autoencoder  0.798450         0.795711      0.717586  0.747361     0.793911       0.970957  0.778641   0.748062   0.844961

6. FACE VERIFICATION STUDY
PCA features:
Cosine AUC: 0.5709, EER: 0.4500
Autoencoder features:
Cosine AUC: 0.5777, EER: 0.4420

Verification Performance (AUC & EER):
PCA_cosine: AUC=0.5709, EER=0.4500
Autoencoder_cosine: AUC=0.5777, EER=0.4420

7. t-SNE VISUALIZATION
Generating t-SNE graph...

8. SAVING TRAINED MODELS
Saving best PCA and Autoencoder models...

Pipeline completed successfully.


EXTRA: CLASSIFICATION ON ORIGINAL HIGH-DIMENSIONAL DATA

--- METRICS SUMMARY: SVM on original data ---
Accuracy: 0.8101
Macro F1: 0.7446
Weighted F1: 0.8017
ROC AUC (Macro): 0.9840
  Epoch 1/100 - Loss: 1.8528 - Acc: 0.3301
  Epoch 20/100 - Loss: 0.1185 - Acc: 0.9621
  Epoch 40/100 - Loss: 0.0680 - Acc: 0.9728
  Epoch 60/100 - Loss: 0.0385 - Acc: 0.9854
  Epoch 80/100 - Loss: 0.1120 - Acc: 0.9553
  Epoch 100/100 - Loss: 0.0337 - Acc: 0.9874

--- METRICS SUMMARY: NN on original data ---
Accuracy: 0.8488
Macro F1: 0.8229
Weighted F1: 0.8502
ROC AUC (Macro): 0.9784
